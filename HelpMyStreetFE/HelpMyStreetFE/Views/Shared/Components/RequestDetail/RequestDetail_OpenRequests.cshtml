@using HelpMyStreetFE.Helpers;
@using HelpMyStreet.Utils.Enums;
@using HelpMyStreet.Utils.Extensions;
@using HelpMyStreet.Utils.Utils;
@using Westwind.AspNetCore.Markdown

@model HelpMyStreetFE.Models.Account.Jobs.RequestDetailViewModel

@{
    var requestSummary = Model.RequestDetail.RequestSummary;
    var requestId = Base64Utils.Base64Encode(requestSummary.RequestID);
    var role = Base64Utils.Base64Encode((int)Model.UserRole);

    //var questionsToDisplay = Model.JobDetails.First().JobSummary.Questions.Where(q => q.ShowOnTaskManagement(true, false) && !string.IsNullOrEmpty(q.Answer));
}

<div class="job__expander">
    <div class="row">
        <div class="sm12">
            <dl>
                <dt>When is the help needed?</dt>

                @if (Model.OpenJobsForUser.Count() == 1)
                {
                    <dd>
                        <partial name="_WhenIsHelpNeeded_ShortFormat" model="Model.OpenJobsForUser.First()" />
                    </dd>
                }
                else
                {
                    <dd>
                        <p class="mt-0 mb-0">This help is needed on @Model.OpenJobsForUser.Count() separate occasions:</p>
                        <ul>
                            @foreach (var jobSummary in Model.OpenJobsForUser)
                            {
                                <li>
                                    <partial name="_WhenIsHelpNeeded_ShortFormat" model="jobSummary" />
                                </li>
                            }
                        </ul>
                        <p class="mb-0">When you click &lsquo;Accept&rsquo; above, you can choose which dates to accept.</p>
                    </dd>
                }
            </dl>
        </div>
    </div>
</div>
